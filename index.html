<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="./assets/img/favicon.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    空汙查詢精靈
  </title>
  <meta content='width=device-width, initial-scale=1.0, shrink-to-fit=no' name='viewport' />
  <!--     Fonts and icons     -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  <!-- CSS Files -->
  <link href="./assets/css/material-kit.css?v=2.0.7" rel="stylesheet" />
  <!-- CSS Just for demo purpose, don't include it in your project -->
  <link href="./assets/demo/demo.css" rel="stylesheet" />
</head>

<body class="index-page sidebar-collapse">
    <nav class="navbar navbar-transparent navbar-color-on-scroll fixed-top navbar-expand-lg" color-on-scroll="100" id="sectionsNav">
        <div class="container">
            <div class="navbar-translate">
                <a class="navbar-brand" href="https://hsumh.github.io/Database-FP/">
                  <h3>
                    空汙查詢精靈 
                  </h3>                
                </a>                
            </div>            
        </div>
    </nav>
    <div class="page-header header-filter clear-filter purple-filter" data-parallax="true" style="background-image: url('./assets/img/bg2.jpg');">
      <div class="container">
        <div class="row">
          <div class="col-md-8 ml-auto mr-auto">
            <div class="brand">
              <h1 class="title">Final Project</h1>
              <h2 class="title">Team04</h2>
              <h3 class="title">M10915078 游紹宏</h3>
              <h3 class="title">M10915054 高培循 </h3>
              <h3 class="title">M10915071 徐明漢 </h3>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="main main-raised">

      <div class="section">
        <div class="container">
          <div class="row">
            <div class="card col-md-12 mr-auto ml-auto" style="margin:30px 30px">
              <div class="card-body">
                  <div class="col-md-8 mx-auto text-center">
                    <h2 class="title">空氣品質指標 Air Quality index</h2>
                  </div>
                  <p>
                    <h5>
                    空氣品質指標為依據監測資料將當日空氣中臭氧(O3)、細懸浮微粒(PM2.5)、懸浮微粒(PM10)、一氧化碳(CO)、二氧化硫(SO2)及二氧化氮(NO2)濃度等數值，以其對人體健康的影響程度，分別換算出不同污染物之副指標值，再以當日各副指標之最大值為該測站當日之空氣品質指標值(AQI)。
                    </h5>
                  </p>
                  <table style="text-align: center; 
                      width: auto; 
                      flex-direction: column;
                      justify-content: center;">
                      <tr style="
                          text-align-last: justify;
                          -moz-text-align-last: justify ;  
                          text-align: justify;
                          text-justify: distribute-all-lines;">
                          <td style="width: 17%;  transition: width 1.5s ease;">
                              0
                          </td>
                          <td style="width: 17%;  transition: width 1.5s ease;">
                              51
                          </td>
                          <td style="width: 17%;  transition: width 1.5s ease;">
                              101
                          </td>
                          <td style="width: 17%;  transition: width 1.5s ease;">
                              151
                          </td>
                          <td style=" width: 17%;  transition: width 1.5s ease;">
                              201
                          </td>
                          <td style=" width: 50%;  transition: width 1.5s ease;">
                              301 500
                        </td>
                      </tr>
                      <tr style="height: fit-content;">
                          <td>
                              <div class="progress progress-line-danger" style="margin-bottom: 10px;">
                                  <div class="progress-bar" style="width: 100%; background: #009865;">
                                      <span class="sr-only">35% Complete (success)</span>
                                  </div>
                              </div>
                          </td>
                          <td>
                              <div class="progress progress-line-danger" style="margin-bottom: 10px;">
                                  <div class="progress-bar" style="width: 100%; background: #fffb26;">
                                      <span class="sr-only">35% Complete (success)</span>
                                  </div>
                              </div>
                          </td>
                          <td>
                              <div class="progress progress-line-danger" style="margin-bottom: 10px;">
                                  <div class="progress-bar" style="width: 100%; background: #ff9734;">
                                      <span class="sr-only">35% Complete (success)</span>
                                  </div>
                              </div>
                          </td>
                          <td>
                              <div class="progress progress-line-danger" style="margin-bottom: 10px;">
                                  <div class="progress-bar" style="width: 100%; background: #ca0034;">
                                      <span class="sr-only">35% Complete (success)</span>
                                  </div>
                              </div>
                          </td>
                          <td>
                              <div class="progress progress-line-danger" style="margin-bottom: 10px;">
                                  <div class="progress-bar" style="width: 100%; background: #670099;">
                                      <span class="sr-only">35% Complete (success)</span>
                                  </div>
                              </div>
                          </td>
                          <td>
                            <div class="progress progress-line-danger" style="margin-bottom: 10px;">
                                <div class="progress-bar" style="width: 100%; background: #7e0123;">
                                    <span class="sr-only">35% Complete (success)</span>
                                </div>
                            </div>
                        </td>
                      </tr>
                      <tr style="height: fit-content;">
                          <td>
                              &nbsp;良好&nbsp;
                          </td>
                          <td>
                              &nbsp;普通&nbsp;
                          </td>
                          <td>
                              &nbsp;對敏感族群不健康&nbsp;
                          </td>
                          <td>
                              &nbsp;對所有敏感族群不健康&nbsp;
                          </td>
                          <td>
                              &nbsp;非常不健康&nbsp;
                          </td>
                          <td>
                            &nbsp;危害等級&nbsp;
                        </td>
                      </tr>
                  </table>
                  <br><b>© 資料來源：</b> <a href="https://www.cwb.gov.tw/V8/C/" target="_blank" style="color:#248da3">中央氣象局</a> 與 <a href="https://airtw.epa.gov.tw/" target="_blank" style="color:#248da3">行政院環境保護署 (空氣品質監測網)</a>
              </div>
            </div>
          </div>
        </div>
      </div>


        <div class="container">
          <div class="row">              
            <div class="col-md-10 mx-auto text-center">
              <h2 class="title">現在天氣概況</h1>
              <div id="weather_report"></div>
              
              <div class="section">
                <div class="row"> 
                  <div class="col-md-8 mx-auto text-center">
                    <h4>更新時間 • <b> 
                      <script>
                        var today = new Date();
                        var nowTime = today.getTime();
                        today.setTime(parseInt(nowTime));
                        var oYear = today.getFullYear().toString();
                        var oMoth = (today.getMonth() + 1).toString();
                        var oDay = today.getDate().toString();
                        var oHour = today.getHours().toString();
                        if (oMoth.length <= 1) { oMoth = '0' + oMoth; }
                        if (oDay.length <= 1) { oDay = '0' + oDay; }
                        if (oHour.length <= 1) { oHour = '0' + oHour; }
                        document.write(oYear + "/" + oMoth + "/" + oDay + " " + oHour + ":00")
                      </script>
                    </b></h4>
                    <a href="https://assistant.google.com/services/invoke/uid/000000fa049fc5e5" class="btn btn-white btn-round" target="_blank"><b><span class="iconify" data-icon="mdi-google-assistant" data-inline="false"></span>&emsp;Try it on Google Assistant</b></a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        


        <div class="container col-md-12">
          <div class="col-md-12 mx-auto">
            <div class="card card-nav-tabs card-plain">
              <div class="card-header card-header-primary">
                <div class="nav-tabs-navigation">
                  <div class="nav-tabs-wrapper">
                    <ul class="nav nav-tabs" data-tabs="tabs">
                      <li class="nav-item">
                        <a class="nav-link active" href="#Taipei_nav" data-toggle="tab">
                          <h4>
                            臺北
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Keelung_nav" data-toggle="tab">
                          <h4>
                            基隆
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#NewTaipei_nav" data-toggle="tab">
                          <h4>
                            新北
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Taoyuan_nav" data-toggle="tab">
                          <h4>
                            桃園
                         </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Hsinchu_nav" data-toggle="tab">
                          <h4>
                            新竹
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Miaoli_nav" data-toggle="tab">
                          <h4>
                            苗栗
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Taichung_nav" data-toggle="tab">
                          <h4>
                            台中
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Changhua_nav" data-toggle="tab">
                          <h4>
                            彰化
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Nantou_nav" data-toggle="tab">
                          <h4>
                            南投
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Yunlin_nav" data-toggle="tab">
                          <h4>
                            雲林
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Chiayi_nav" data-toggle="tab">
                          <h4>
                            嘉義
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Tainan_nav" data-toggle="tab">
                          <h4>
                            台南
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Kaohsiung_nav" data-toggle="tab">
                          <h4>
                            高雄
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Pingtung_nav" data-toggle="tab">
                          <h4>
                            屏東
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Yilan_nav" data-toggle="tab">
                          <h4>
                            宜蘭
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Hualien_nav" data-toggle="tab">
                          <h4>
                            花蓮
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#Taitung_nav" data-toggle="tab">
                          <h4>
                            台東
                          </h4>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#OuterIsland_nav" data-toggle="tab">
                          <h4>
                            離島地區
                          </h4>
                        </a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="card-body">
                <div class="tab-content text-center">
                  <div class="row tab-pane active" id="Taipei_nav">
                    
                  </div>
                  <div class="tab-pane" id="Keelung_nav">

                  </div>
                  <div class="tab-pane" id="NewTaipei_nav">

                  </div>                
                  <div class="tab-pane" id="Taoyuan_nav">

                  </div>
                  <div class="tab-pane" id="Hsinchu_nav">

                  </div>
                  <div class="tab-pane" id="Miaoli_nav">

                  </div>
                  <div class="tab-pane" id="Taichung_nav">

                  </div>
                  <div class="tab-pane" id="Changhua_nav">
                    
                  </div>
                  <div class="tab-pane" id="Nantou_nav">
                    
                  </div>
                  <div class="tab-pane" id="Yunlin_nav">
                    
                  </div>
                  <div class="tab-pane" id="Chiayi_nav">
                    
                  </div>
                  <div class="tab-pane" id="Tainan_nav">
                    
                  </div>
                  <div class="tab-pane" id="Kaohsiung_nav">
                    
                  </div>
                  <div class="tab-pane" id="Pingtung_nav">
                    
                  </div>
                  <div class="tab-pane" id="Yilan_nav">
                    
                  </div>
                  <div class="tab-pane" id="Hualien_nav">
                    
                  </div>
                  <div class="tab-pane" id="Taitung_nav">
                    
                  </div>
                  <div class="tab-pane" id="OuterIsland_nav">
                    
                  </div>
                </div>
              </div>
            </div>            
          </div>
        </div>

    </div>
  


    <footer class="footer footer-default">
        <div class="container">
            <nav class="float-left">
                <ul>

                    <li>
                        <a href="https://www.creative-tim.com/license">
              Licenses
            </a>
                    </li>
                </ul>
            </nav>
            <div class="copyright float-right">
                &copy;
                <script>
                    document.write(new Date().getFullYear())
                </script>, made with <i class="material-icons">favorite</i> by
                <a href="https://www.creative-tim.com/" target="_blank">Creative Tim</a> for a better web.
            </div>
        </div>
    </footer>
    
    <!--   Core JS Files   -->
    <script src="./assets/js/core/jquery.min.js" type="text/javascript"></script>
    <script src="./assets/js/core/popper.min.js" type="text/javascript"></script>
    <script src="./assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
    <script src="./assets/js/plugins/moment.min.js"></script>
    <!--	Plugin for the Datepicker, full documentation here: https://github.com/Eonasdan/bootstrap-datetimepicker -->
    <script src="./assets/js/plugins/bootstrap-datetimepicker.js" type="text/javascript"></script>
    <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
    <script src="./assets/js/plugins/nouislider.min.js" type="text/javascript"></script>
    <!--  Google Maps Plugin    -->
    <!-- Control Center for Material Kit: parallax effects, scripts for the example pages etc -->
    <script src="./assets/js/material-kit.js?v=2.0.7" type="text/javascript"></script>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.5.0/firebase-database.js"></script>
    <!-- TODO: Add SDKs for Firebase products that you want to use
    https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
    
    <script src="./fetch.js"></script>


    <script>
      // Your web app's Firebase configuration
      var firebaseConfig = {
          apiKey: "AIzaSyD7QTtDBeC-O0tjPGfr6HjO-tK3Qz8J_L0",
          authDomain: "b1a2b-krmfch.firebaseapp.com",
          databaseURL: "https://b1a2b-krmfch.firebaseio.com",
          projectId: "b1a2b-krmfch",
          storageBucket: "b1a2b-krmfch.appspot.com",
          messagingSenderId: "777443303063",
          appId: "1:777443303063:web:ad45bae1d1dd1f85ded3d2"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);


    

      var database = firebase.database();

      
      
      
      
      var Taipei = ["士林", "大同", "中山", "古亭", "松山", "陽明", "萬華"];
      var Keelung = ["基隆"];
      var NewTaipei = ["三重", "土城", "永和", "汐止", "板橋", "林口", "淡水", "富貴角", "菜寮", "新店", "新莊", "萬里"];      
      var Taoyuan = ["大園", "中壢", "平鎮", "桃園", "龍潭", "觀音"];
      var Hsinchu = ["新竹", "竹東", "湖口"];
      var Miaoli = ["三義", "苗栗", "頭份"];
      var Taichung = ["大里", "西屯", "沙鹿", "忠明", "豐原"];
      var Changhua = ["二林", "彰化", "線西"];
      var Nantou = ["竹山", "南投", "埔里"];
      var Yunlin = ["斗六", "崙背", "麥寮", "臺西"];
      var Chiayi = ["嘉義", "朴子", "新港"];
      var Tainan = ["安南", "善化", "新營", "臺南"];
      var Kaohsiung = ["美濃", "橋頭", "楠梓", "仁武", "左營", "前金", "鳳山", "復興", "前鎮", "小港", "大寮", "林園"];
      var Pingtung = ["屏東", "恆春", "潮州"];
      var Yilan = ["冬山", "宜蘭"];
      var Hualien = ["花蓮"];
      var Taitung = ["臺東", "關山"];
      var OuterIsland = ["金門", "馬公", "馬祖"];

      
      var city = [Taipei, Keelung, NewTaipei, Taoyuan, Hsinchu, Miaoli, Taichung, Changhua, Nantou, 
                  Yunlin, Chiayi, Tainan, Kaohsiung, Pingtung, Yilan, Hualien, Taitung, OuterIsland];
      
      var cityCh = ['臺北', '基隆', '新北', '桃園', '新竹', '苗栗', '台中', '彰化', '南投', '雲林', '嘉義', '台南', '高雄', '屏東', '宜蘭', '花蓮', '台東', '離島地區'];
      var cityNav = ['Taipei_nav', 'Keelung_nav', 'NewTaipei_nav', 'Taoyuan_nav', 'Hsinchu_nav', 'Miaoli_nav', 'Taichung_nav', 'Changhua_nav', 'Nantou_nav', 
                      'Yunlin_nav', 'Chiayi_nav', 'Tainan_nav', 'Kaohsiung_nav', 'Pingtung_nav', 'Yilan_nav', 'Hualien_nav', 'Taitung_nav', 'OuterIsland_nav'];
      
      var myData = firebase.database().ref('/TWair');


      myData.once('value', function(snapshot) {
        let reportContentF = '';
        let reportContentb = '';
        reportContentF = reportContentF +
        '<h5>';
        reportContentb = reportContentb +
        '</h5>';
        document.getElementById("weather_report").innerHTML = reportContentF + snapshot.val().report + reportContentb;
        

        for (var c = 0; c < city.length; c++) {
          let content = '';
          let content1 = '';
          let content2 = '';

          content1 = content1 +
                  '<div class="container">' +
                    
                      '<div class="row">' +
                        '<div class="col-md-8 ml-auto mr-auto">' +
                          '<h4 class="description">' + "共" + city[c].length + "個監測站" + '</h4>' +
                        '</div>' +
                      '</div>' +
                      
                      
                      '<div class="features">' +
                        '<div class="row" id="' + cityCh[c] + '">' ;


          for (var i = 0; i < city[c].length; i++) {
              var name = city[c][i];
              var data = snapshot.val().data[name]

              
              content = content +
                          '<div class="col-md-3 ml-auto mr-auto">' +
                            '<div class="card">' +
                              '<div class="card-body" style="padding: 0;">' +
                                '<img class="card-img-top" src="' + picture_generator(data.AQI) + '" rel="nofollow" alt="Card image cap">' +
                                '<div class = "card-body" >' +
                                  '<p class = "card-text"> ' +
                                    '<h3 class="card-title">' + name + '</h3>' +
                                    '<h3 class="card-text">' + status_generator(data.AQI) + '</h3>' +
                                    '<h7 class="card-text"><small class="text-muted">' + info_output_generator(data.AQI) + '</small></h7>' +
                                  '</p>' +
                                '</div>' +
                              '</div>' +
                            '</div>' +
                          '</div>' ;
          }

          content2 = content2 + 
                        '</div>' +
                      '</div>' +
                    '</div>';
          document.getElementById(cityNav[c]).innerHTML = content1 + content + content2
          
          
          
        } 
      })
    </script>

</body>

</html>